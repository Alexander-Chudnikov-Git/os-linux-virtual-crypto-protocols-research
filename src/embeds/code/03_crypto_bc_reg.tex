\begin{minted}{c}
static struct crypto_alg xor_cipher_alg =
{
    .cra_name = "xor-cipher",
    .cra_driver_name = "xor-cipher-generic",
    .cra_priority = 100,
    .cra_flags = CRYPTO_ALG_TYPE_CIPHER,
    .cra_blocksize = XOR_CIPHER_BLOCK_SIZE,
    .cra_ctxsize = sizeof(struct xor_cipher_ctx),
    .cra_module = THIS_MODULE,
    .cra_u.cipher =
    {
        .cia_min_keysize = XOR_CIPHER_KEY_SIZE,
        .cia_max_keysize = XOR_CIPHER_KEY_SIZE,
        .cia_setkey = xor_cipher_setkey,
        .cia_encrypt = xor_cipher_crypt,
        .cia_decrypt = xor_cipher_crypt
    }
};

static int __init xor_cipher_init(void)
{
    return crypto_register_alg(&xor_cipher_alg);
}

static void __exit xor_cipher_exit(void)
{
    crypto_unregister_alg(&xor_cipher_alg);
}

module_init(xor_cipher_init);
module_exit(xor_cipher_exit);
\end{minted}
